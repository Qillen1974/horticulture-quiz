<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üå± Horticulture Quiz - Learn Plants!</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: #276749;
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 5px;
        }

        .category-selector {
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 15px;
            background: #f0fff4;
            flex-wrap: wrap;
        }

        .category-btn {
            padding: 12px 20px;
            font-size: 1rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            background: #c6f6d5;
            color: #276749;
        }

        .category-btn.active {
            background: #48bb78;
            color: white;
            transform: scale(1.05);
        }

        .quiz-area {
            padding: 25px;
        }

        .question-card {
            background: #f0fff4;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }

        .question-emoji {
            font-size: 4rem;
            margin-bottom: 15px;
        }

        .question-image {
            max-width: 100%;
            max-height: 250px;
            border-radius: 10px;
            margin-bottom: 15px;
            object-fit: contain;
        }

        .question-text {
            font-size: 1.4rem;
            color: #2d3748;
            margin-bottom: 10px;
        }

        .question-hint {
            font-size: 1rem;
            color: #718096;
        }

        .options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 15px 0;
        }

        @media (max-width: 600px) {
            .options {
                grid-template-columns: 1fr;
            }
            .match-container {
                flex-direction: column;
            }
            .match-column {
                width: 100% !important;
            }
        }

        .option-btn {
            padding: 15px;
            font-size: 1.1rem;
            border: 3px solid #e2e8f0;
            border-radius: 10px;
            cursor: pointer;
            background: white;
            transition: all 0.3s;
            font-weight: bold;
            color: #2d3748;
        }

        .option-btn:hover {
            border-color: #48bb78;
            background: #f0fff4;
        }

        .option-btn.correct {
            border-color: #48bb78;
            background: #c6f6d5;
            color: #22543d;
        }

        .option-btn.incorrect {
            border-color: #f56565;
            background: #fed7d7;
            color: #742a2a;
        }

        .option-btn:disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        .feedback {
            text-align: center;
            font-size: 1.2rem;
            margin: 15px 0;
            padding: 12px;
            border-radius: 10px;
            display: none;
        }

        .feedback.correct {
            background: #c6f6d5;
            color: #22543d;
            display: block;
        }

        .feedback.incorrect {
            background: #fed7d7;
            color: #742a2a;
            display: block;
        }

        .next-btn {
            display: block;
            margin: 15px auto;
            padding: 12px 30px;
            font-size: 1.1rem;
            background: #48bb78;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
        }

        .next-btn:hover {
            background: #38a169;
        }

        .score {
            text-align: center;
            font-size: 1.1rem;
            color: #718096;
            padding: 12px;
            background: #f7fafc;
            border-radius: 10px;
            margin-top: 15px;
        }

        .score-number {
            font-size: 1.8rem;
            font-weight: bold;
            color: #48bb78;
        }

        .explanation {
            background: #ebf8ff;
            border-left: 4px solid #4299e1;
            padding: 12px;
            margin: 12px 0;
            border-radius: 0 8px 8px 0;
            display: none;
            font-size: 0.95rem;
        }

        .explanation.show {
            display: block;
        }

        /* Match styles */
        .match-container {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .match-column {
            width: 45%;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .match-column h3 {
            text-align: center;
            color: #276749;
            margin-bottom: 5px;
        }

        .match-item {
            padding: 12px;
            border: 3px solid #e2e8f0;
            border-radius: 10px;
            cursor: pointer;
            background: white;
            transition: all 0.3s;
            text-align: center;
            font-weight: bold;
            color: #2d3748;
            user-select: none;
        }

        .match-item:hover {
            border-color: #48bb78;
            background: #f0fff4;
        }

        .match-item.selected {
            border-color: #4299e1;
            background: #ebf8ff;
            transform: scale(1.03);
        }

        .match-item.matched {
            border-color: #48bb78;
            background: #c6f6d5;
            cursor: default;
            opacity: 0.8;
        }

        .match-item.wrong {
            border-color: #f56565;
            background: #fed7d7;
            animation: shake 0.4s;
        }

        .match-item img {
            max-width: 100%;
            max-height: 80px;
            border-radius: 6px;
            object-fit: contain;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }

        .match-score {
            text-align: center;
            font-size: 1.3rem;
            color: #276749;
            font-weight: bold;
            margin: 15px 0;
        }

        .match-round-info {
            text-align: center;
            font-size: 1.1rem;
            color: #718096;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üå± Horticulture Quiz</h1>
            <p>Learn about plants and gardening!</p>
        </div>

        <div class="category-selector">
            <button class="category-btn active" onclick="setCategory('tools', this)">üîß Tools</button>
            <button class="category-btn" onclick="setCategory('toolparts', this)">üî© Tool Parts</button>
            <button class="category-btn" onclick="setCategory('toolquality', this)">‚úÖ Tool Quality</button>
            <button class="category-btn" onclick="setCategory('match', this)">üîó Match Tools</button>
            <button class="category-btn" onclick="setCategory('propagation', this)">üåø Propagation</button>
            <button class="category-btn" onclick="setCategory('media', this)">ü™¥ Soil Mix</button>
            <button class="category-btn" onclick="setCategory('matchmedia', this)">üîó Match Media</button>
        </div>

        <!-- Standard quiz area -->
        <div class="quiz-area" id="quizArea">
            <div class="question-card">
                <img class="question-image" id="questionImage" style="display:none" alt="Question image">
                <div class="question-emoji" id="questionEmoji">‚úÇÔ∏è</div>
                <div class="question-text" id="questionText">What tool is this?</div>
                <div class="question-hint" id="questionHint">Select the correct answer!</div>
            </div>

            <div class="options" id="options"></div>

            <div class="explanation" id="explanation"></div>

            <div class="feedback" id="feedback"></div>

            <button class="next-btn" id="nextBtn" onclick="nextQuestion()" style="display: none;">Next Question ‚û°Ô∏è</button>

            <div class="score">
                <div>Score</div>
                <div class="score-number" id="scoreNumber">0</div>
                <div id="scoreText">Correct: 0 | Total: 0</div>
            </div>
        </div>

        <!-- Match area (shared by Match Tools and Match Media) -->
        <div class="quiz-area" id="matchArea" style="display: none;">
            <div class="match-round-info" id="matchRoundInfo">Round 1: Match each tool to its name</div>
            <div class="match-container" id="matchContainer"></div>
            <div class="match-score" id="matchScore"></div>
            <button class="next-btn" id="matchNextBtn" style="display: none;">Next Round ‚û°Ô∏è</button>
            <button class="next-btn" id="matchRestartBtn" style="display: none;">Play Again üîÑ</button>
        </div>
    </div>

    <script>
        let currentCategory = 'tools';
        let score = { correct: 0, total: 0 };
        let currentQuestion = {};
        let answered = false;

        // Match state
        let matchSelectedLeft = null;
        let matchSelectedRight = null;
        let matchPairs = [];
        let matchMatched = 0;
        let matchRound = 1;
        let matchCorrect = 0;
        let matchTotal = 0;
        let activeMatchType = 'tools'; // 'tools' or 'media'

        const toolData = [
            { image: "images/tools images/IMG_9968.jpeg", name: "Hand Trowel", func: "Dig, scoop, and smooth soil media" },
            { image: "images/tools images/IMG_9969.jpeg", name: "Secateurs", func: "Cut stems, leaves, and roots" },
            { image: "images/tools images/IMG_9970.jpeg", name: "Hand Fork", func: "Loosen soil and remove weeds" },
            { image: "images/tools images/IMG_9971.jpeg", name: "Pungkis", func: "Collect debris during weeding" },
            { image: "images/tools images/IMG_9972.jpeg", name: "Rake", func: "Sweep dried leaves and dirt" },
            { image: "images/tools images/IMG_9973.jpeg", name: "Watering Can", func: "Water plants" },
            { image: "images/tools images/IMG_9974.jpeg", name: "Wheelbarrow", func: "Carry soil, plants, and debris" }
        ];

        const mediaData = [
            { image: "images/media images/IMG_9959.jpeg", name: "Sand", func: "Improves drainage" },
            { image: "images/media images/IMG_9960.jpeg", name: "Top Soil", func: "Provides nutrients" },
            { image: "images/media images/IMG_9961.jpeg", name: "Cocopeat", func: "Holds water" },
            { image: "images/media images/IMG_9962.jpeg", name: "Perlite", func: "Aeration and drainage" },
            { image: "images/media images/IMG_9963.jpeg", name: "Vermiculite", func: "Water and nutrient retention" }
        ];

        const questions = {
            tools: [
                { image: "images/tools images/IMG_9968.jpeg", question: "What tool is this?", options: ["Hand Trowel", "Secateurs", "Hand Fork", "Pungkis"], correct: 0, explanation: "Hand Trowel - used to dig, scoop, and smooth soil media!" },
                { image: "images/tools images/IMG_9968.jpeg", question: "What is this tool's function?", options: ["Dig, scoop, smooth soil", "Cut stems/leaves", "Loosen soil, remove weeds", "Collect debris"], correct: 0, explanation: "The Hand Trowel is for digging, scooping, and smoothing soil!" },
                { image: "images/tools images/IMG_9969.jpeg", question: "What tool is this?", options: ["Secateurs", "Hand Trowel", "Hand Fork", "Rake"], correct: 0, explanation: "Secateurs - pruning shears for cutting!" },
                { image: "images/tools images/IMG_9969.jpeg", question: "What is this tool's function?", options: ["Cut stems, leaves, roots", "Dig soil", "Water plants", "Sweep leaves"], correct: 0, explanation: "Secateurs cut stems, leaves, and roots!" },
                { image: "images/tools images/IMG_9970.jpeg", question: "What tool is this?", options: ["Hand Fork", "Hand Trowel", "Secateurs", "Pungkis"], correct: 0, explanation: "Hand Fork!" },
                { image: "images/tools images/IMG_9970.jpeg", question: "What is this tool's function?", options: ["Loosen soil, remove weeds", "Cut stems", "Carry things", "Water plants"], correct: 0, explanation: "The Hand Fork loosens soil and removes weeds!" },
                { image: "images/tools images/IMG_9971.jpeg", question: "What tool is this?", options: ["Pungkis", "Wheelbarrow", "Rake", "Watering Can"], correct: 0, explanation: "Pungkis - a basket/scoop for collecting debris!" },
                { image: "images/tools images/IMG_9971.jpeg", question: "What is this tool's function?", options: ["Collect debris during weeding", "Carry soil", "Water plants", "Cut stems"], correct: 0, explanation: "Pungkis collects debris during weeding!" },
                { image: "images/tools images/IMG_9972.jpeg", question: "What tool is this?", options: ["Rake", "Hand Fork", "Wheelbarrow", "Watering Can"], correct: 0, explanation: "Rake!" },
                { image: "images/tools images/IMG_9972.jpeg", question: "What is this tool's function?", options: ["Sweep dried leaves and dirt", "Cut stems", "Water plants", "Dig soil"], correct: 0, explanation: "The Rake sweeps dried leaves and dirt!" },
                { image: "images/tools images/IMG_9973.jpeg", question: "What tool is this?", options: ["Watering Can", "Wheelbarrow", "Pungkis", "Secateurs"], correct: 0, explanation: "Watering Can!" },
                { image: "images/tools images/IMG_9973.jpeg", question: "What is this tool's function?", options: ["Water plants", "Carry soil", "Cut stems", "Loosen soil"], correct: 0, explanation: "The Watering Can is used to water plants!" },
                { image: "images/tools images/IMG_9974.jpeg", question: "What tool is this?", options: ["Wheelbarrow", "Rake", "Pungkis", "Hand Fork"], correct: 0, explanation: "Wheelbarrow!" },
                { image: "images/tools images/IMG_9974.jpeg", question: "What is this tool's function?", options: ["Carry soil, plants, debris", "Water plants", "Cut stems", "Sweep leaves"], correct: 0, explanation: "The Wheelbarrow carries soil, plants, and debris!" }
            ],
            toolparts: [
                { image: "images/tools images/IMG_9958.jpeg", question: "What is Part A on the secateurs?", options: ["Blades", "Safety Lock Catch", "Handle", "Spring"], correct: 0, explanation: "Part A = Blades - the sharp cutting edges of the secateurs!" },
                { image: "images/tools images/IMG_9958.jpeg", question: "What is Part B on the secateurs?", options: ["Safety Lock Catch", "Blades", "Handle", "Pivot Bolt"], correct: 0, explanation: "Part B = Safety Lock Catch - keeps the secateurs closed when not in use!" },
                { image: "images/tools images/IMG_9958.jpeg", question: "What is Part C on the secateurs?", options: ["Handle", "Blades", "Safety Lock Catch", "Spring"], correct: 0, explanation: "Part C = Handle - where you grip the secateurs!" },
                { image: "images/tools images/IMG_9958.jpeg", question: "Which part are the Blades?", options: ["Part A", "Part B", "Part C", "Part D"], correct: 0, explanation: "The Blades are labeled as Part A!" },
                { image: "images/tools images/IMG_9958.jpeg", question: "Which part is the Safety Lock Catch?", options: ["Part B", "Part A", "Part C", "Part D"], correct: 0, explanation: "The Safety Lock Catch is labeled as Part B!" },
                { image: "images/tools images/IMG_9958.jpeg", question: "Which part is the Handle?", options: ["Part C", "Part A", "Part B", "Part D"], correct: 0, explanation: "The Handle is labeled as Part C!" }
            ],
            toolquality: [
                { image: "images/tools images/IMG_9964.jpeg", question: "Is this tool in good or poor condition?", options: ["Poor quality", "Good quality"], correct: 0, explanation: "Poor condition - the secateur blade is rusty and worn, making it unsafe and ineffective!" },
                { image: "images/tools images/IMG_9965.jpeg", question: "Is this tool in good or poor condition?", options: ["Good quality", "Poor quality"], correct: 0, explanation: "Good condition - this hand trowel is new and in proper working order!" },
                { image: "images/tools images/IMG_9966.jpeg", question: "Is this tool in good or poor condition?", options: ["Good quality", "Poor quality"], correct: 0, explanation: "Good condition - these secateurs are in use and well-maintained!" },
                { image: "images/tools images/IMG_9967.jpeg", question: "Is this tool in good or poor condition?", options: ["Poor quality", "Good quality"], correct: 0, explanation: "Poor condition - the trowel handle is broken and detached, making it unusable!" }
            ],
            propagation: [
                { emoji: "‚úÇÔ∏è", question: "What propagation method is this?", options: ["Stem Cutting", "Layering", "Division", "Seeds"], correct: 0, explanation: "‚úÇÔ∏è Stem cutting involves cutting a stem and planting it!" },
                { emoji: "üå±", question: "What is this propagation method?", options: ["Layering", "Cutting", "Grafting", "Division"], correct: 0, explanation: "üå± Layering - bending branch to ground!" },
                { emoji: "‚ûó", question: "What is this propagation method?", options: ["Division", "Cutting", "Layering", "Air layering"], correct: 0, explanation: "‚ûó Division - splitting a plant!" },
                { emoji: "üå∞", question: "What is this propagation method?", options: ["Seeds", "Cutting", "Division", "Layering"], correct: 0, explanation: "üå∞ Growing from seeds!" },
                { emoji: "üîó", question: "What is this method?", options: ["Air Layering", "Ground Layering", "Cutting", "Grafting"], correct: 0, explanation: "üîó Air layering - roots on branch!" },
                { emoji: "üåø", question: "When taking cuttings, what is important?", options: ["Cut below a node", "Cut any place", "Cut the leaves", "Cut at night"], correct: 0, explanation: "üåø Cut below a node for roots!" },
                { emoji: "üíß", question: "What do cuttings need to root?", options: ["Moisture and warmth", "Fertilizer", "Sunlight", "Insects"], correct: 0, explanation: "üíß Moisture and warmth!" },
                { emoji: "üçÉ", question: "Should cuttings have leaves?", options: ["Yes, some leaves help", "No leaves at all", "Remove all leaves", "It doesn't matter"], correct: 0, explanation: "üçÉ Some leaves help photosynthesis!" },
                { emoji: "üïê", question: "How long do cuttings take to root?", options: ["2-6 weeks", "1 day", "1 year", "Immediately"], correct: 0, explanation: "üïê 2-6 weeks!" },
                { emoji: "üå°Ô∏è", question: "Best temperature for rooting?", options: ["20-25¬∞C", "0¬∞C", "40¬∞C", "10¬∞C"], correct: 0, explanation: "üå°Ô∏è 20-25¬∞C is best!" }
            ],
            media: [
                { image: "images/media images/IMG_9959.jpeg", question: "What soil media is this?", options: ["Sand", "Top Soil", "Cocopeat", "Perlite"], correct: 0, explanation: "Sand - the grainy, light-colored media that improves drainage!" },
                { image: "images/media images/IMG_9959.jpeg", question: "What is the function of Sand?", options: ["Improves drainage", "Holds water", "Adds nutrients", "Retains moisture"], correct: 0, explanation: "Sand improves drainage in the soil mix!" },
                { image: "images/media images/IMG_9960.jpeg", question: "What soil media is this?", options: ["Top Soil", "Sand", "Cocopeat", "Vermiculite"], correct: 0, explanation: "Top Soil - the dark, nutrient-rich soil!" },
                { image: "images/media images/IMG_9960.jpeg", question: "What is the function of Top Soil?", options: ["Provides nutrients", "Improves drainage", "Holds water", "Lightweight"], correct: 0, explanation: "Top Soil provides nutrients for plants!" },
                { image: "images/media images/IMG_9961.jpeg", question: "What soil media is this?", options: ["Cocopeat", "Top Soil", "Vermiculite", "Sand"], correct: 0, explanation: "Cocopeat - the brown fibrous material made from coconut husks!" },
                { image: "images/media images/IMG_9961.jpeg", question: "What is the function of Cocopeat?", options: ["Holds water", "Improves drainage", "Adds nitrogen", "Makes soil heavy"], correct: 0, explanation: "Cocopeat holds water and keeps the soil moist!" },
                { image: "images/media images/IMG_9962.jpeg", question: "What soil media is this?", options: ["Perlite", "Vermiculite", "Sand", "Cocopeat"], correct: 0, explanation: "Perlite - the white, lightweight granules!" },
                { image: "images/media images/IMG_9962.jpeg", question: "What is the function of Perlite?", options: ["Aeration and drainage", "Holds water", "Adds nutrients", "Keeps soil cool"], correct: 0, explanation: "Perlite improves aeration and drainage!" },
                { image: "images/media images/IMG_9963.jpeg", question: "What soil media is this?", options: ["Vermiculite", "Perlite", "Sand", "Top Soil"], correct: 0, explanation: "Vermiculite - the golden, flaky material!" },
                { image: "images/media images/IMG_9963.jpeg", question: "What is the function of Vermiculite?", options: ["Water and nutrient retention", "Improves drainage", "Makes soil light", "Kills bacteria"], correct: 0, explanation: "Vermiculite retains water and nutrients!" }
            ]
        };

        function setCategory(category, btnElement) {
            currentCategory = category;
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            btnElement.classList.add('active');

            if (category === 'match' || category === 'matchmedia') {
                document.getElementById('quizArea').style.display = 'none';
                document.getElementById('matchArea').style.display = 'block';
                activeMatchType = category === 'match' ? 'tools' : 'media';
                startMatch();
            } else {
                document.getElementById('quizArea').style.display = 'block';
                document.getElementById('matchArea').style.display = 'none';
                newQuestion();
            }
        }

        function newQuestion() {
            const categoryQuestions = questions[currentCategory];
            currentQuestion = categoryQuestions[Math.floor(Math.random() * categoryQuestions.length)];
            answered = false;

            const emojiEl = document.getElementById('questionEmoji');
            const imageEl = document.getElementById('questionImage');

            if (currentQuestion.image) {
                emojiEl.style.display = 'none';
                imageEl.src = currentQuestion.image;
                imageEl.style.display = 'block';
            } else {
                emojiEl.style.display = 'block';
                emojiEl.textContent = currentQuestion.emoji;
                imageEl.style.display = 'none';
            }

            document.getElementById('questionText').textContent = currentQuestion.question;
            document.getElementById('feedback').className = 'feedback';
            document.getElementById('feedback').style.display = 'none';
            document.getElementById('explanation').className = 'explanation';
            document.getElementById('nextBtn').style.display = 'none';

            let options = [...currentQuestion.options];
            let correctOption = options[0];
            options = shuffleArray(options);
            let correctIndex = options.indexOf(correctOption);

            const optionsContainer = document.getElementById('options');
            optionsContainer.innerHTML = '';

            options.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = option;
                btn.onclick = () => checkAnswer(index, btn, correctIndex, optionsContainer);
                optionsContainer.appendChild(btn);
            });

            playSound('question');
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function checkAnswer(selectedIndex, btn, correctIndex, container) {
            if (answered) return;
            answered = true;

            const buttons = container.querySelectorAll('.option-btn');
            buttons.forEach(b => b.disabled = true);

            score.total++;

            if (selectedIndex === correctIndex) {
                score.correct++;
                btn.classList.add('correct');
                document.getElementById('feedback').textContent = 'üéâ Correct!';
                document.getElementById('feedback').className = 'feedback correct';
                playSound('correct');
            } else {
                btn.classList.add('incorrect');
                buttons[correctIndex].classList.add('correct');
                document.getElementById('feedback').textContent = '‚ùå Not quite!';
                document.getElementById('feedback').className = 'feedback incorrect';
                playSound('incorrect');
            }

            document.getElementById('explanation').textContent = currentQuestion.explanation;
            document.getElementById('explanation').className = 'explanation show';

            document.getElementById('scoreNumber').textContent = score.correct;
            document.getElementById('scoreText').textContent = `Correct: ${score.correct} | Total: ${score.total}`;

            document.getElementById('nextBtn').style.display = 'block';
        }

        function nextQuestion() {
            newQuestion();
        }

        // ========== Match (Tools & Media) ==========

        function getActiveMatchData() {
            return activeMatchType === 'tools' ? toolData : mediaData;
        }

        function startMatch() {
            matchRound = 1;
            matchCorrect = 0;
            matchTotal = 0;
            const nextBtn = document.getElementById('matchNextBtn');
            const restartBtn = document.getElementById('matchRestartBtn');
            nextBtn.style.display = 'none';
            restartBtn.style.display = 'none';
            nextBtn.onclick = () => { matchRound = 2; nextBtn.style.display = 'none'; buildMatchRound(); };
            restartBtn.onclick = () => startMatch();
            buildMatchRound();
        }

        function buildMatchRound() {
            matchSelectedLeft = null;
            matchSelectedRight = null;
            matchMatched = 0;

            const data = getActiveMatchData();
            const container = document.getElementById('matchContainer');
            container.innerHTML = '';

            const label = activeMatchType === 'tools' ? 'tool' : 'media';
            const isRound1 = matchRound === 1;
            document.getElementById('matchRoundInfo').textContent = isRound1
                ? `Round 1: Match each ${label} to its name`
                : `Round 2: Match each ${label} to its function`;

            document.getElementById('matchScore').textContent = '';
            document.getElementById('matchNextBtn').style.display = 'none';
            document.getElementById('matchRestartBtn').style.display = 'none';

            const leftCol = document.createElement('div');
            leftCol.className = 'match-column';
            leftCol.innerHTML = `<h3>${activeMatchType === 'tools' ? 'Tools' : 'Media'}</h3>`;

            const rightCol = document.createElement('div');
            rightCol.className = 'match-column';
            rightCol.innerHTML = isRound1 ? '<h3>Names</h3>' : '<h3>Functions</h3>';

            const leftOrder = shuffleArray([...Array(data.length).keys()]);
            const rightOrder = shuffleArray([...Array(data.length).keys()]);

            matchPairs = data.map((t, i) => ({ index: i, matched: false }));

            leftOrder.forEach(i => {
                const item = document.createElement('div');
                item.className = 'match-item';
                item.dataset.index = i;
                item.dataset.side = 'left';
                item.innerHTML = `<img src="${data[i].image}" alt="${label}"><br><small>?</small>`;
                item.onclick = () => selectMatchItem(item);
                leftCol.appendChild(item);
            });

            rightOrder.forEach(i => {
                const item = document.createElement('div');
                item.className = 'match-item';
                item.dataset.index = i;
                item.dataset.side = 'right';
                item.textContent = isRound1 ? data[i].name : data[i].func;
                item.onclick = () => selectMatchItem(item);
                rightCol.appendChild(item);
            });

            container.appendChild(leftCol);
            container.appendChild(rightCol);
        }

        function selectMatchItem(item) {
            if (item.classList.contains('matched')) return;

            const side = item.dataset.side;
            const data = getActiveMatchData();

            if (side === 'left') {
                if (matchSelectedLeft) matchSelectedLeft.classList.remove('selected');
                matchSelectedLeft = item;
                item.classList.add('selected');
            } else {
                if (matchSelectedRight) matchSelectedRight.classList.remove('selected');
                matchSelectedRight = item;
                item.classList.add('selected');
            }

            if (matchSelectedLeft && matchSelectedRight) {
                const leftIndex = parseInt(matchSelectedLeft.dataset.index);
                const rightIndex = parseInt(matchSelectedRight.dataset.index);
                matchTotal++;

                if (leftIndex === rightIndex) {
                    matchCorrect++;
                    matchSelectedLeft.classList.remove('selected');
                    matchSelectedRight.classList.remove('selected');
                    matchSelectedLeft.classList.add('matched');
                    matchSelectedRight.classList.add('matched');
                    const label = matchSelectedLeft.querySelector('small');
                    if (label) label.textContent = data[leftIndex].name;
                    matchMatched++;
                    playSound('correct');

                    matchSelectedLeft = null;
                    matchSelectedRight = null;

                    if (matchMatched === data.length) {
                        document.getElementById('matchScore').textContent =
                            `Round ${matchRound} complete! ${matchCorrect}/${matchTotal} correct`;
                        if (matchRound === 1) {
                            document.getElementById('matchNextBtn').style.display = 'block';
                        } else {
                            document.getElementById('matchScore').textContent +=
                                ' ‚Äî All done! Great work!';
                            document.getElementById('matchRestartBtn').style.display = 'block';
                        }
                    }
                } else {
                    playSound('incorrect');
                    matchSelectedLeft.classList.add('wrong');
                    matchSelectedRight.classList.add('wrong');
                    const left = matchSelectedLeft;
                    const right = matchSelectedRight;
                    setTimeout(() => {
                        left.classList.remove('selected', 'wrong');
                        right.classList.remove('selected', 'wrong');
                    }, 500);
                    matchSelectedLeft = null;
                    matchSelectedRight = null;
                }
            }
        }

        function playSound(type) {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);

                if (type === 'correct') {
                    oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime);
                    oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1);
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.3);
                } else if (type === 'incorrect') {
                    oscillator.frequency.setValueAtTime(300, audioContext.currentTime);
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.2);
                } else {
                    oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
                    gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.1);
                }
            } catch (e) {}
        }

        newQuestion();
    </script>
</body>
</html>
